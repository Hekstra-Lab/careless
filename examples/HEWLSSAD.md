### Lysozyme Sulfur Sad 
This example shows how to process conventional data with `careless`. 
The data set is hen egg white lysozyme room temperature collected at the Advanced Photon Source [beamline 24-ID C](https://necat.chem.cornell.edu/newsite/technical-specifications-24-id-c-beamline).
In total, 1,440 images procesed with [DIALS](https://dials.github.io/) yielded 411,944 reflections which are saved in `careless/examples/data/hewl_sad`.
These data were collected at low energy, roughly 6.5 keV, and contain substantial sulfur anomalous signal. 
In this tutorial, you will learn how to merge this data set and make an anomalous difference map. 
First enter the `hewl_sad` directory and type `rs.mtzdump integrated_pass1.mtz`.


    Spacegroup: P43212
    Extended Hermann-Mauguin name: P 43 21 2
    Unit cell dimensions: 79.331 79.331 37.797 90.000 90.000 90.000
    
    mtz.head():
    
               BATCH       IPR    SIGIPR  ...         LP         QE  PARTIAL
    H   K  L                              ...                               
    -18 -3 -1      1  2132.026 28.435514  ... 0.37233505 0.99992234    False
    -17 -5 -1      1 1176.6364 21.382341  ... 0.38172576 0.99991775    False
        -4 -1      1  423.9999 12.702219  ... 0.36751527  0.9999155    False
        -3 -1      1  959.0282 18.556822  ... 0.35317278  0.9999137    False
        -2 -1      1 1366.0074  21.63609  ... 0.33865514  0.9999124    False
    
    [5 rows x 14 columns]
    
    mtz.describe():
    
                BATCH         IPR      SIGIPR  ...         ROT          LP         QE
    count  411944.000  411944.000  411944.000  ...  411944.000  411944.000  4.119e+05
    mean      720.336     526.871      13.843  ...     359.916       0.620  1.000e+00
    std       415.688     768.623       8.308  ...     207.845       0.222  3.908e-05
    min         1.000      -6.885       0.160  ...       0.048       0.012  9.998e-01
    25%       360.000      63.042       7.491  ...     179.948       0.470  1.000e+00
    50%       720.000     217.598      11.822  ...     359.964       0.646  1.000e+00
    75%      1081.000     656.902      18.227  ...     540.001       0.796  1.000e+00
    max      1440.000   10126.892      66.644  ...     719.949       1.078  1.000e+00
    
    [8 rows x 13 columns]
    
    mtz.dtypes:
    
    BATCH               Batch
    IPR             Intensity
    SIGIPR             Stddev
    I               Intensity
    SIGI               Stddev
    BG                MTZReal
    SIGBG             MTZReal
    FRACTIONCALC      MTZReal
    XDET              MTZReal
    YDET              MTZReal
    ROT               MTZReal
    LP                MTZReal
    QE                MTZReal
    PARTIAL              bool
    dtype: object


These are the default columns from DIALS processing.
There are two intensity columns corresponding to profile fitting and summation. 
By default, the first intensity column will be used exclusively. 
You can switch to a different column with the `--intensity-key` flag. 
First make an output directory and then call `careless`

	mkdir merge
	careless mono \
		--anomalous \
		--iterations=100000 \
		"BATCH,dHKL,Hobs,Kobs,Lobs,XDET,YDET,BG,SIGBG,LP,QE,FRACTIONCALC" \
		integrated_pass1.mtz \
		merge/hewl

The `dHKL,Hobs,Kobs,Lobs` metadata keys are automatically generated by `careless` and are always available through the command line app. 
Using a combination of those four keys implies anisotropic scaling. 
To do strictly isotropic scaling, just pass the `dHKL` metadata key.
This will take rather a long time to run on a conventional laptop. 
It should take about an hour on an NVIDIA V100. 
If you would like to finish quicker, fewer iterations can be used for less accurate structure factors. 

After running, the merge directory will contain several output Mtzs. 
`merge/hewl_0.mtz` will contain the full set of merged structure factors. 
Use this file for a refinement run to make a map. 

    mkdir merge/phenix
    cd merge/phenix
    phenix.refine ../hewl_0.mtz ../../refine.eff ../../HEWL_S-SAD_refine_9.pdb b

Afterward, inspect the results in coot by calling `coot hewlssad_refine_1.*`
This command will automatically load the structure, the `2fo-fc` electron density map, and the `fo-fc` difference map. 
In order to get the anomalous difference map to inspect the anomalous signal, we need to reload `hewlssad_refine_1..mtz` and select the `ANOM` amplitudes and `PHANOM` phases. 

![HEWL Anomalous](images/hewl-load-anomalous.gif)
